{"version":3,"sources":["webpack://danmu.js/webpack/universalModuleDefinition","webpack://danmu.js/webpack/bootstrap","webpack://danmu.js/./src/utils/util.js","webpack://danmu.js/./src/baseClass.js","webpack://danmu.js/./node_modules/es5-ext/object/is-value.js","webpack://danmu.js/./node_modules/type/value/is.js","webpack://danmu.js/./src/index.js","webpack://danmu.js/./src/danmu.js","webpack://danmu.js/./node_modules/event-emitter/index.js","webpack://danmu.js/./node_modules/d/index.js","webpack://danmu.js/./node_modules/type/plain-function/is.js","webpack://danmu.js/./node_modules/type/function/is.js","webpack://danmu.js/./node_modules/type/prototype/is.js","webpack://danmu.js/./node_modules/type/object/is.js","webpack://danmu.js/./node_modules/es5-ext/object/assign/index.js","webpack://danmu.js/./node_modules/es5-ext/object/assign/is-implemented.js","webpack://danmu.js/./node_modules/es5-ext/object/assign/shim.js","webpack://danmu.js/./node_modules/es5-ext/object/keys/index.js","webpack://danmu.js/./node_modules/es5-ext/object/keys/is-implemented.js","webpack://danmu.js/./node_modules/es5-ext/object/keys/shim.js","webpack://danmu.js/./node_modules/es5-ext/function/noop.js","webpack://danmu.js/./node_modules/es5-ext/object/valid-value.js","webpack://danmu.js/./node_modules/es5-ext/object/normalize-options.js","webpack://danmu.js/./node_modules/es5-ext/string/#/contains/index.js","webpack://danmu.js/./node_modules/es5-ext/string/#/contains/is-implemented.js","webpack://danmu.js/./node_modules/es5-ext/string/#/contains/shim.js","webpack://danmu.js/./node_modules/es5-ext/object/valid-callable.js","webpack://danmu.js/./src/utils/logger.js","webpack://danmu.js/./src/control.js","webpack://danmu.js/./src/main.js","webpack://danmu.js/./src/bullet.js","webpack://danmu.js/./src/channel.js","webpack://danmu.js/./src/utils/validator.js","webpack://danmu.js/./src/domRecycle.js","webpack://danmu.js/./src/resizeObserver.js","webpack://danmu.js/./src/style/index.scss?2278","webpack://danmu.js/./src/style/index.scss","webpack://danmu.js/./node_modules/css-loader/lib/css-base.js","webpack://danmu.js/./node_modules/style-loader/lib/addStyles.js","webpack://danmu.js/./node_modules/style-loader/lib/urls.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","hasClass","el","className","classList","Array","some","item","match","RegExp","addClass","replace","split","forEach","add","removeClass","remove","reg","typeOf","obj","toString","createDom","tpl","attrs","cname","dom","document","createElement","innerHTML","keys","setAttribute","toggleClass","findDom","sel","querySelector","e","startsWith","getElementById","slice","deepCopy","dst","src","Node","concat","copyDom","nodeType","back","tagName","attributes","node","attachEventListener","event","fn","offEvent","on","once","onDestroy","off","offInDestroy","_fn","data","styleUtil","elem","style","error","setProperty","isNumber","val","Number","isNaN","throttle","func","wait","timer","args","clearTimeout","setTimeout","apply","BaseClass","this","logger","Log","_undefined","DanmuJs","options","self","setLogger","info","version","config","overlap","area","start","end","lines","undefined","live","comments","direction","needResizeObserver","dropStaleComments","channelSize","maxCommentsLength","bulletOffset","interval","hideArr","domObj","RecyclableDomList","freezeId","comment","duration","container","emit","containerStyle","player","bulletBtn","Control","main","isReady","addResizeObserver","addObserver","resize","pause","play","stop","clear","k","unObserver","destroy","txt","id","opacity","fontSize","prior","realTime","unshift","readData","dataHandle","push","oldID","newID","queue","pauseMove","status","startMove","like","setLikeDom","danmu","_releaseCtrl","mouseControl","_freezeCtrl","filter","isClear","priorComments","deleteCount","length","sortData","attached_","currentTime","Math","floor","timePoint","splice","willChange","willChanges","force","forceDuration","playRate","size","reflow","setFontSize","top","channel_id","topInit","channel","resizeSync","indexOf","arr","color","index","bullets","containerPos","methods","descriptors","base","callable","Function","defineProperties","descriptor","configurable","writable","type","listener","arguments","__eeOnceListener__","__ee__","listeners","candidate","isValue","isPlainFunction","assign","normalizeOpts","contains","dscr","w","desc","gs","set","isFunction","classRe","functionToString","test","isPrototype","isObject","constructor","possibleTypes","foo","bar","trzy","max","dest","TypeError","process","opts1","result","String","str","searchString","DEBUG","location","href","Logger","constructorName","message","optionalParams","console","log","Main","defaultOff","state","switchBtn","Channel","playedData","retryStatus","_status","updateQueue","nums","handleId","handleTimer","_cancelDataHandleTimer","rdata","bullet","requestAnimationFrame","reset","init","channels","resized","list","updatePos","tryCount","ListLoop","Bullet","bulletCreateFail","attach","addBullet","detach","noDiscard","sort","prev","cur","bookChannelId","reuseDOM","parentNode","disableCopyDOM","use","copyDOM","eventListeners","eventListener","addEventListener","useCapture","appendChild","textContent","onChangeDirection","offset","width","random","updateOffset","elPos","getBoundingClientRect","height","moveV","mouseoverFunWrapper","mouseoverFun","mouseEnterControl","mouseEnterFunWrapper","_onTransitionEnd","removeEventListener","removeChild","unused","join","mouseControlPause","isFullscreen","_moveV","ctPos","pastDuration","Date","getTime","moveTime","pastS","nowS","moveMoreS","moveContainerHeight","moveContainerWidth","left","startTime","hasMove","leftDuration","bottom","bulletPos","leftDistance","right","children","outerHTML","v","removeBullet","pos","containerWidth","containerHeight","containerTop","containerBottom","containerLeft","containerRight","_cancelResizeTimer","channelHeight","channelWidth","occupy","ceil","flag","j","operating","scroll","bookId","curBullet","curBulletPos","curS","curV","curT","newV","catchS","catchT","bOffset","deleteIndex","deleteItem","nextAddTime","channelId","loop","sync","layout","channelCount","validAreaLineRule","navigator","userAgent","num","resizing","resizeId","cancelAnimationFrame","isInit","channelReset","resetId","line","isInteger","RecyclableDOMList","initDOM","initSize","idleList","usingList","_id","_expand","firseIdle","shift","idx","textcontent","clearElementStyle","element","ua","resizeObserver","__handlers","ResizeObserver","observer","entries","__trigger","err","target","handler","observe","map","unobserve","disconnect","__runHandler","destroyObserver","content","transform","locals","useSourceMap","cssMapping","btoa","sourceMapping","sourceMap","unescape","encodeURIComponent","JSON","stringify","sourceURLs","sources","source","sourceRoot","cssWithMappingToString","mediaQuery","alreadyImportedModules","memo","stylesInDom","isOldIE","all","atob","getTarget","getElement","styleTarget","HTMLIFrameElement","contentDocument","head","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","domStyle","refs","parts","addStyle","listToStyles","newStyles","part","css","media","insertStyleElement","insertInto","Error","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","firstChild","before","removeStyleElement","createStyleElement","addAttrs","update","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","updateLink","applyToTag","newObj","newList","mayRemove","textStore","replaceText","replacement","Boolean","styleSheet","cssText","cssNode","createTextNode","childNodes","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","baseUrl","protocol","host","currentDir","pathname","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"danmu.js\"] = factory();\n\telse\n\t\troot[\"danmu.js\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","export function createDom(el = 'div', tpl = '', attrs = {}, cname = '') {\n  const dom = document.createElement(el)\n  dom.className = cname\n  dom.innerHTML = tpl\n  Object.keys(attrs).forEach((item) => {\n    const key = item\n    const value = attrs[item]\n    if (el === 'video' || el === 'audio') {\n      if (value) {\n        dom.setAttribute(key, value)\n      }\n    } else {\n      dom.setAttribute(key, value)\n    }\n  })\n  return dom\n}\n\nexport function hasClass(el, className) {\n  if (el.classList) {\n    return Array.prototype.some.call(el.classList, (item) => item === className)\n  } else {\n    return !!el.className.match(new RegExp('(\\\\s|^)' + className + '(\\\\s|$)'))\n  }\n}\n\nexport function addClass(el, className) {\n  if (el.classList) {\n    className\n      .replace(/(^\\s+|\\s+$)/g, '')\n      .split(/\\s+/g)\n      .forEach((item) => {\n        item && el.classList.add(item)\n      })\n  } else if (!hasClass(el, className)) {\n    el.className += ' ' + className\n  }\n}\n\nexport function removeClass(el, className) {\n  if (el.classList) {\n    className.split(/\\s+/g).forEach((item) => {\n      el.classList.remove(item)\n    })\n  } else if (hasClass(el, className)) {\n    className.split(/\\s+/g).forEach((item) => {\n      const reg = new RegExp('(\\\\s|^)' + item + '(\\\\s|$)')\n      el.className = el.className.replace(reg, ' ')\n    })\n  }\n}\n\nexport function toggleClass(el, className) {\n  className.split(/\\s+/g).forEach((item) => {\n    if (hasClass(el, item)) {\n      removeClass(el, item)\n    } else {\n      addClass(el, item)\n    }\n  })\n}\n\nexport function findDom(el = document, sel) {\n  let dom\n  // fix querySelector IDs that start with a digit\n  // https://stackoverflow.com/questions/37270787/uncaught-syntaxerror-failed-to-execute-queryselector-on-document\n  try {\n    dom = el.querySelector(sel)\n  } catch (e) {\n    if (sel.startsWith('#')) {\n      dom = el.getElementById(sel.slice(1))\n    }\n  }\n  return dom\n}\n\nexport function deepCopy(dst, src) {\n  if (typeOf(src) === 'Object' && typeOf(dst) === 'Object') {\n    Object.keys(src).forEach((key) => {\n      if (typeOf(src[key]) === 'Object' && !(src[key] instanceof Node)) {\n        if (!dst[key]) {\n          dst[key] = src[key]\n        } else {\n          deepCopy(dst[key], src[key])\n        }\n      } else if (typeOf(src[key]) === 'Array') {\n        dst[key] = typeOf(dst[key]) === 'Array' ? dst[key].concat(src[key]) : src[key]\n      } else {\n        dst[key] = src[key]\n      }\n    })\n    return dst\n  }\n}\n\nexport function typeOf(obj) {\n  return Object.prototype.toString.call(obj).match(/([^\\s.*]+)(?=]$)/g)[0]\n}\n\nexport function copyDom(dom) {\n  if (dom && dom.nodeType === 1) {\n    const back = document.createElement(dom.tagName)\n    Array.prototype.forEach.call(dom.attributes, (node) => {\n      back.setAttribute(node.name, node.value)\n    })\n    if (dom.innerHTML) {\n      back.innerHTML = dom.innerHTML\n    }\n    return back\n  } else {\n    return ''\n  }\n}\n\nfunction offInDestroy(object, event, fn, offEvent) {\n  function onDestroy() {\n    object.off(event, fn)\n    object.off(offEvent, onDestroy)\n  }\n  object.once(offEvent, onDestroy)\n}\n\nexport function attachEventListener(object, event, fn, offEvent) {\n  if (offEvent) {\n    object.on(event, fn)\n    offInDestroy(object, event, fn, offEvent)\n  } else {\n    const _fn = (data) => {\n      fn(data)\n      object.off(event, _fn)\n    }\n    object.on(event, _fn)\n  }\n}\n\n/**\n * @param {HTMLElement} elem\n * @param {string} name\n * @param {string} value\n */\nexport function styleUtil(elem, name, value) {\n  const style = elem.style\n  try {\n    style[name] = value\n  } catch (error) {\n    style.setProperty(name, value)\n  }\n}\n\nexport function isNumber(val) {\n  return typeof val === 'number' && !Number.isNaN(val)\n}\n\n/**\n * Simple throttle \n * @param {()=>void} func \n * @param {number} wait \n * @returns \n */\nexport function throttle(func, wait) {\n  let timer = 0\n  return (...args) => {\n    clearTimeout(timer)\n    timer = setTimeout(() => func.apply(this, args), wait)\n  }\n}\n\nexport const hasOwnProperty = Object.prototype.hasOwnProperty\n","import Log from './utils/logger'\n\nclass BaseClass {\n  setLogger(name = '') {\n    this.logger = new Log(name + '.js')\n  }\n}\n\nexport default BaseClass\n","\"use strict\";\n\nvar _undefined = require(\"../function/noop\")(); // Support ES3 engines\n\nmodule.exports = function (val) { return val !== _undefined && val !== null; };\n","\"use strict\";\n\n// ES3 safe\nvar _undefined = void 0;\n\nmodule.exports = function (value) { return value !== _undefined && value !== null; };\n","import DanmuJs from './danmu'\nimport './style/index.scss'\nexport default DanmuJs\n","import EventEmitter from 'event-emitter'\nimport { version } from '../version.json'\nimport BaseClass from './baseClass'\nimport Control from './control'\nimport RecyclableDomList from './domRecycle'\nimport { addObserver, unObserver } from './resizeObserver'\nimport { addClass, deepCopy, isNumber, styleUtil } from './utils/util'\n\nexport class DanmuJs extends BaseClass {\n  constructor(options) {\n    super()\n    const self = this\n\n    // logger\n    self.setLogger('danmu')\n    self.logger && self.logger.info(`danmu.js version: ${version}`)\n\n    // configure\n    const config = (self.config = {\n      overlap: false,\n      area: {\n        start: 0,\n        end: 1,\n        lines: undefined\n      },\n      live: false,\n      comments: [],\n      direction: 'r2l',\n      needResizeObserver: false,\n      dropStaleComments: false,\n      channelSize: undefined,\n      maxCommentsLength: undefined,\n      bulletOffset: undefined,\n      interval: 2000\n    })\n    deepCopy(config, options)\n\n    // Add event subscription handler\n    EventEmitter(self)\n\n    self.hideArr = []\n    self.domObj = new RecyclableDomList()\n\n    // freezed comment\n    self.freezeId = null\n\n    config.comments.forEach((comment) => {\n      comment.duration = comment.duration ? comment.duration : 5000\n      if (!comment.mode) {\n        comment.mode = 'scroll'\n      }\n    })\n\n    /**\n     * @type {HTMLElement}\n     */\n    self.container = config.container && config.container.nodeType === 1 ? config.container : null\n    if (!self.container) {\n      // eslint-disable-next-line quotes\n      self.emit('error', \"container id can't be empty\")\n      return false\n    }\n    if (config.containerStyle) {\n      let style = config.containerStyle\n      Object.keys(style).forEach(function (key) {\n        self.container.style[key] = style[key]\n      })\n    }\n    self.live = config.live\n    self.player = config.player\n    self.direction = config.direction\n    addClass(self.container, 'danmu')\n    self.bulletBtn = new Control(self)\n    self.main = self.bulletBtn.main\n    self.isReady = true\n    self.emit('ready')\n    this.logger && this.logger.info('ready')\n    this.addResizeObserver()\n  }\n\n  get status() {\n    return this.main.status\n  }\n\n  get state() {\n    const main = this.main\n    return {\n      status: main.status,\n      comments: main.data,\n      bullets: main.queue\n    }\n  }\n\n  get containerPos() {\n    return this.main.channel.containerPos\n  }\n\n  addResizeObserver() {\n    this.config.needResizeObserver &&\n      addObserver(this.container, () => {\n        this.logger && this.logger.info('needResizeObserver')\n        this.resize()\n      })\n  }\n\n  start() {\n    this.logger && this.logger.info('start')\n    this.main.start()\n  }\n\n  pause() {\n    this.logger && this.logger.info('pause')\n    this.main.pause()\n  }\n\n  play() {\n    this.logger && this.logger.info('play')\n    this.main.play()\n  }\n\n  stop() {\n    this.logger && this.logger.info('stop')\n    this.main.stop()\n  }\n\n  clear() {\n    this.logger && this.logger.info('clear')\n    this.main.clear()\n  }\n\n  destroy() {\n    unObserver(this.container)\n    this.logger && this.logger.info('destroy')\n    this.stop()\n    this.bulletBtn.destroy()\n    this.domObj.destroy()\n    for (let k in this) {\n      delete this[k]\n    }\n    this.emit('destroy')\n  }\n\n  sendComment(comment) {\n    this.logger && this.logger.info(`sendComment: ${comment.txt || '[DOM Element]'}`)\n    if (!comment.duration) {\n      comment.duration = 15000\n    }\n    if (comment && comment.id && comment.duration && (comment.el || comment.txt)) {\n      comment.duration = comment.duration ? comment.duration : 5000\n      if (!comment.style) {\n        comment.style = {\n          opacity: undefined,\n          fontSize: undefined\n        }\n      }\n      if (comment.style) {\n        if (this.opacity && this.opacity !== comment.style.opacity) {\n          comment.style.opacity = this.opacity\n        }\n        if (this.fontSize && this.fontSize !== comment.style.fontSize) {\n          comment.style.fontSize = this.fontSize\n        }\n      }\n      if (comment.prior || comment.realTime) {\n        this.main.data.unshift(comment)\n        if (comment.realTime) {\n          this.main.readData()\n          this.main.dataHandle()\n        }\n      } else {\n        this.main.data.push(comment)\n      }\n    }\n  }\n\n  setCommentID(oldID, newID) {\n    this.logger && this.logger.info(`setCommentID: oldID ${oldID} newID ${newID}`)\n    if (oldID && newID) {\n      this.main.data.some((data) => {\n        if (data.id === oldID) {\n          data.id = newID\n          return true\n        } else {\n          return false\n        }\n      })\n      this.main.queue.some((item) => {\n        if (item.id === oldID) {\n          item.id = newID\n          item.pauseMove()\n          this.main.status !== 'paused' && item.startMove()\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  setCommentDuration(id, duration) {\n    this.logger && this.logger.info(`setCommentDuration: id ${id} duration ${duration}`)\n\n    if (id && duration) {\n      duration = duration ? duration : 5000\n      this.main.data.some((data) => {\n        if (data.id === id) {\n          data.duration = duration\n          return true\n        } else {\n          return false\n        }\n      })\n      this.main.queue.some((item) => {\n        if (item.id === id) {\n          item.duration = duration\n          item.pauseMove()\n          this.main.status !== 'paused' && item.startMove()\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  setCommentLike(id, like) {\n    this.logger && this.logger.info(`setCommentLike: id ${id} like ${like}`)\n    if (id && like) {\n      this.main.data.some((data) => {\n        if (data.id === id) {\n          data.like = like\n          return true\n        } else {\n          return false\n        }\n      })\n      this.main.queue.some((item) => {\n        if (item.id === id) {\n          item.pauseMove()\n          item.setLikeDom(like.el, like.style)\n          if (item.danmu.main.status !== 'paused') {\n            item.startMove()\n          }\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  restartComment(id) {\n    this.logger && this.logger.info(`restartComment: id ${id}`)\n\n    if (id) {\n      const self = this\n      const main = self.main\n\n      self._releaseCtrl(id)\n\n      if (main.status === 'closed') {\n        // The main process has been stopped, there is no need to drive the barrage to run\n        return\n      }\n\n      main.queue.some((item) => {\n        if (item.id === id) {\n          if (main.status !== 'paused') {\n            item.startMove(true)\n          } else {\n            item.status = 'paused'\n          }\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  /**\n   * @private\n   */\n  _releaseCtrl(id) {\n    const self = this\n\n    if (self.freezeId && id == self.freezeId) {\n      self.mouseControl = false\n      self.freezeId = null\n    }\n  }\n\n  /**\n   * @private\n   */\n  _freezeCtrl(id) {\n    this.mouseControl = true\n    this.freezeId = id\n  }\n\n  freezeComment(id) {\n    this.logger && this.logger.info(`freezeComment: id ${id}`)\n\n    if (id) {\n      const self = this\n\n      self._freezeCtrl(id)\n\n      self.main.queue.some((item) => {\n        if (item.id === id) {\n          item.status = 'forcedPause'\n          item.pauseMove()\n          if (item.el && item.el.style) {\n            styleUtil(item.el, 'zIndex', 10)\n          }\n          return true\n        } else {\n          return false\n        }\n      })\n    }\n  }\n\n  removeComment(id) {\n    this.logger && this.logger.info(`removeComment: id ${id}`)\n\n    if (id) {\n      const self = this\n      self._releaseCtrl(id)\n\n      self.main.queue.some((item) => {\n        if (item.id === id) {\n          item.remove()\n          return true\n        } else {\n          return false\n        }\n      })\n      self.main.data = self.main.data.filter((item) => {\n        return item.id !== id\n      })\n    }\n  }\n\n  /**\n   * @param {Array<import('./main').CommentData>} comments\n   * @param {boolean} isClear\n   */\n  updateComments(comments, isClear = true) {\n    const { config, main, player } = this\n    const priorComments = []\n    let deleteCount = 0\n\n    this.logger && this.logger.info(`updateComments: ${comments.length}, isClear ${isClear}`)\n\n    if (typeof isClear === 'boolean' && isClear) {\n      main.data = []\n    }\n    main.data = main.data.concat(comments)\n    main.sortData()\n\n    // Support data pool to control watermark automatically\n    if (typeof config.maxCommentsLength === 'number' && main.data.length > config.maxCommentsLength) {\n      deleteCount = main.data.length - config.maxCommentsLength\n\n      for (let i = 0, comment; i < deleteCount; i++) {\n        comment = main.data[i]\n        if (comment.prior && !comment.attached_) {\n          priorComments.push(main.data[i])\n        }\n      }\n    } else if (config.dropStaleComments && player && player.currentTime) {\n      const currentTime = Math.floor(player.currentTime * 1000),\n        timePoint = currentTime - config.interval\n\n      if (timePoint > 0) {\n        for (let i = 0, comment; i < main.data.length; i++) {\n          comment = main.data[i]\n          if (comment.prior && !comment.attached_) {\n            priorComments.push(main.data[i])\n          }\n\n          if (comment.start > timePoint) {\n            deleteCount = i\n            break\n          }\n        }\n      }\n\n      if (deleteCount > 0) {\n        main.data.splice(0, deleteCount)\n\n        // Keep high-priority comments data.\n        main.data = priorComments.concat(main.data)\n      }\n    }\n  }\n\n  willChange() {\n    const { container, main } = this\n    // optimize setOpacity\n    container.style.willChange = 'opacity'\n\n    // optimize setAllDuration/setFontSize\n    main.willChanges.push('contents')\n    main.queue.forEach((item) => {\n      item.willChange()\n    })\n  }\n\n  stopWillChange() {\n    this.container.style.willChange = ''\n\n    this.main.willChanges.splice(0) // empty\n    this.main.queue.forEach((item) => {\n      item.willChange()\n    })\n  }\n\n  /**\n   * 设置所有弹幕播放时长\n   * @param {number} duration\n   */\n  setAllDuration(mode = 'scroll', duration, force = true) {\n    this.logger && this.logger.info(`setAllDuration: mode ${mode} duration ${duration} force ${force}`)\n    if (duration) {\n      duration = duration ? duration : 5000\n      if (force) {\n        this.main.forceDuration = duration\n      }\n      this.main.data.forEach((data) => {\n        if (mode === data.mode) {\n          data.duration = duration\n        }\n      })\n      this.main.queue.forEach((item) => {\n        if (mode === item.mode) {\n          item.duration = duration\n          item.pauseMove()\n          if (this.main.status !== 'paused') {\n            item.startMove()\n          }\n        }\n      })\n    }\n  }\n\n  /**\n   * 设置弹幕播放速率，在弹幕播放速度上乘以一个系数，控制速度的变化\n   * @param {number} val\n   */\n  setPlayRate(mode = 'scroll', val) {\n    this.logger && this.logger.info(`setPlayRate: ${val}`)\n    if (isNumber(val) && val > 0) {\n      this.main.playRate = val\n      this.main.queue.forEach((item) => {\n        if (mode === item.mode) {\n          item.pauseMove()\n          if (this.main.status !== 'paused') {\n            item.startMove()\n          }\n        }\n      })\n    }\n  }\n\n  setOpacity(opacity) {\n    this.logger && this.logger.info(`setOpacity: opacity ${opacity}`)\n    this.container.style.opacity = opacity\n  }\n\n  setFontSize(\n    size,\n    channelSize,\n    options = {\n      reflow: true\n    }\n  ) {\n    this.logger && this.logger.info(`setFontSize: size ${size} channelSize ${channelSize}`)\n    this.fontSize = `${size}px`\n    if (size) {\n      this.main.data.forEach((data) => {\n        if (data.style) {\n          data.style.fontSize = this.fontSize\n        }\n      })\n      this.main.queue.forEach((item) => {\n        if (!item.options.style) {\n          item.options.style = {}\n        }\n\n        item.options.style.fontSize = this.fontSize\n        item.setFontSize(this.fontSize)\n        if (channelSize) {\n          item.top = item.channel_id[0] * channelSize\n          item.topInit()\n        }\n      })\n    }\n    if (channelSize) {\n      this.config.channelSize = channelSize\n\n      if (options.reflow) {\n        this.main.channel.resizeSync()\n      }\n    }\n  }\n\n  setArea(area) {\n    this.logger && this.logger.info(`setArea: area ${area}`)\n    this.config.area = area\n\n    if (area.reflow !== false) {\n      this.main.channel.resizeSync()\n    }\n  }\n\n  hide(mode = 'scroll') {\n    this.logger && this.logger.info(`hide: mode ${mode}`)\n    if (this.hideArr.indexOf(mode) < 0) {\n      this.hideArr.push(mode)\n    }\n    let arr = this.main.queue.filter((item) => mode === item.mode || (mode === 'color' && item.color))\n    arr.forEach((item) => item.remove())\n  }\n\n  show(mode = 'scroll') {\n    this.logger && this.logger.info(`show: mode ${mode}`)\n    let index = this.hideArr.indexOf(mode)\n    if (index > -1) {\n      this.hideArr.splice(index, 1)\n    }\n  }\n\n  setDirection(direction = 'r2l') {\n    this.logger && this.logger.info(`setDirection: direction ${direction}`)\n    this.emit('changeDirection', direction)\n  }\n\n  resize() {\n    this.logger && this.logger.info('resize')\n    this.emit('channel_resize')\n  }\n}\n\nexport default DanmuJs\n","'use strict';\n\nvar d        = require('d')\n  , callable = require('es5-ext/object/valid-callable')\n\n  , apply = Function.prototype.apply, call = Function.prototype.call\n  , create = Object.create, defineProperty = Object.defineProperty\n  , defineProperties = Object.defineProperties\n  , hasOwnProperty = Object.prototype.hasOwnProperty\n  , descriptor = { configurable: true, enumerable: false, writable: true }\n\n  , on, once, off, emit, methods, descriptors, base;\n\non = function (type, listener) {\n\tvar data;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) {\n\t\tdata = descriptor.value = create(null);\n\t\tdefineProperty(this, '__ee__', descriptor);\n\t\tdescriptor.value = null;\n\t} else {\n\t\tdata = this.__ee__;\n\t}\n\tif (!data[type]) data[type] = listener;\n\telse if (typeof data[type] === 'object') data[type].push(listener);\n\telse data[type] = [data[type], listener];\n\n\treturn this;\n};\n\nonce = function (type, listener) {\n\tvar once, self;\n\n\tcallable(listener);\n\tself = this;\n\ton.call(this, type, once = function () {\n\t\toff.call(self, type, once);\n\t\tapply.call(listener, this, arguments);\n\t});\n\n\tonce.__eeOnceListener__ = listener;\n\treturn this;\n};\n\noff = function (type, listener) {\n\tvar data, listeners, candidate, i;\n\n\tcallable(listener);\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return this;\n\tdata = this.__ee__;\n\tif (!data[type]) return this;\n\tlisteners = data[type];\n\n\tif (typeof listeners === 'object') {\n\t\tfor (i = 0; (candidate = listeners[i]); ++i) {\n\t\t\tif ((candidate === listener) ||\n\t\t\t\t\t(candidate.__eeOnceListener__ === listener)) {\n\t\t\t\tif (listeners.length === 2) data[type] = listeners[i ? 0 : 1];\n\t\t\t\telse listeners.splice(i, 1);\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif ((listeners === listener) ||\n\t\t\t\t(listeners.__eeOnceListener__ === listener)) {\n\t\t\tdelete data[type];\n\t\t}\n\t}\n\n\treturn this;\n};\n\nemit = function (type) {\n\tvar i, l, listener, listeners, args;\n\n\tif (!hasOwnProperty.call(this, '__ee__')) return;\n\tlisteners = this.__ee__[type];\n\tif (!listeners) return;\n\n\tif (typeof listeners === 'object') {\n\t\tl = arguments.length;\n\t\targs = new Array(l - 1);\n\t\tfor (i = 1; i < l; ++i) args[i - 1] = arguments[i];\n\n\t\tlisteners = listeners.slice();\n\t\tfor (i = 0; (listener = listeners[i]); ++i) {\n\t\t\tapply.call(listener, this, args);\n\t\t}\n\t} else {\n\t\tswitch (arguments.length) {\n\t\tcase 1:\n\t\t\tcall.call(listeners, this);\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tcall.call(listeners, this, arguments[1]);\n\t\t\tbreak;\n\t\tcase 3:\n\t\t\tcall.call(listeners, this, arguments[1], arguments[2]);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tl = arguments.length;\n\t\t\targs = new Array(l - 1);\n\t\t\tfor (i = 1; i < l; ++i) {\n\t\t\t\targs[i - 1] = arguments[i];\n\t\t\t}\n\t\t\tapply.call(listeners, this, args);\n\t\t}\n\t}\n};\n\nmethods = {\n\ton: on,\n\tonce: once,\n\toff: off,\n\temit: emit\n};\n\ndescriptors = {\n\ton: d(on),\n\tonce: d(once),\n\toff: d(off),\n\temit: d(emit)\n};\n\nbase = defineProperties({}, descriptors);\n\nmodule.exports = exports = function (o) {\n\treturn (o == null) ? create(base) : defineProperties(Object(o), descriptors);\n};\nexports.methods = methods;\n","\"use strict\";\n\nvar isValue         = require(\"type/value/is\")\n  , isPlainFunction = require(\"type/plain-function/is\")\n  , assign          = require(\"es5-ext/object/assign\")\n  , normalizeOpts   = require(\"es5-ext/object/normalize-options\")\n  , contains        = require(\"es5-ext/string/#/contains\");\n\nvar d = (module.exports = function (dscr, value/*, options*/) {\n\tvar c, e, w, options, desc;\n\tif (arguments.length < 2 || typeof dscr !== \"string\") {\n\t\toptions = value;\n\t\tvalue = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[2];\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t\tw = contains.call(dscr, \"w\");\n\t} else {\n\t\tc = w = true;\n\t\te = false;\n\t}\n\n\tdesc = { value: value, configurable: c, enumerable: e, writable: w };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n});\n\nd.gs = function (dscr, get, set/*, options*/) {\n\tvar c, e, options, desc;\n\tif (typeof dscr !== \"string\") {\n\t\toptions = set;\n\t\tset = get;\n\t\tget = dscr;\n\t\tdscr = null;\n\t} else {\n\t\toptions = arguments[3];\n\t}\n\tif (!isValue(get)) {\n\t\tget = undefined;\n\t} else if (!isPlainFunction(get)) {\n\t\toptions = get;\n\t\tget = set = undefined;\n\t} else if (!isValue(set)) {\n\t\tset = undefined;\n\t} else if (!isPlainFunction(set)) {\n\t\toptions = set;\n\t\tset = undefined;\n\t}\n\tif (isValue(dscr)) {\n\t\tc = contains.call(dscr, \"c\");\n\t\te = contains.call(dscr, \"e\");\n\t} else {\n\t\tc = true;\n\t\te = false;\n\t}\n\n\tdesc = { get: get, set: set, configurable: c, enumerable: e };\n\treturn !options ? desc : assign(normalizeOpts(options), desc);\n};\n","\"use strict\";\n\nvar isFunction = require(\"../function/is\");\n\nvar classRe = /^\\s*class[\\s{/}]/, functionToString = Function.prototype.toString;\n\nmodule.exports = function (value) {\n\tif (!isFunction(value)) return false;\n\tif (classRe.test(functionToString.call(value))) return false;\n\treturn true;\n};\n","\"use strict\";\n\nvar isPrototype = require(\"../prototype/is\");\n\nmodule.exports = function (value) {\n\tif (typeof value !== \"function\") return false;\n\n\tif (!hasOwnProperty.call(value, \"length\")) return false;\n\n\ttry {\n\t\tif (typeof value.length !== \"number\") return false;\n\t\tif (typeof value.call !== \"function\") return false;\n\t\tif (typeof value.apply !== \"function\") return false;\n\t} catch (error) {\n\t\treturn false;\n\t}\n\n\treturn !isPrototype(value);\n};\n","\"use strict\";\n\nvar isObject = require(\"../object/is\");\n\nmodule.exports = function (value) {\n\tif (!isObject(value)) return false;\n\ttry {\n\t\tif (!value.constructor) return false;\n\t\treturn value.constructor.prototype === value;\n\t} catch (error) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isValue = require(\"../value/is\");\n\n// prettier-ignore\nvar possibleTypes = { \"object\": true, \"function\": true, \"undefined\": true /* document.all */ };\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) return false;\n\treturn hasOwnProperty.call(possibleTypes, typeof value);\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.assign : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\tvar assign = Object.assign, obj;\n\tif (typeof assign !== \"function\") return false;\n\tobj = { foo: \"raz\" };\n\tassign(obj, { bar: \"dwa\" }, { trzy: \"trzy\" });\n\treturn obj.foo + obj.bar + obj.trzy === \"razdwatrzy\";\n};\n","\"use strict\";\n\nvar keys  = require(\"../keys\")\n  , value = require(\"../valid-value\")\n  , max   = Math.max;\n\nmodule.exports = function (dest, src /*, …srcn*/) {\n\tvar error, i, length = max(arguments.length, 2), assign;\n\tdest = Object(value(dest));\n\tassign = function (key) {\n\t\ttry {\n\t\t\tdest[key] = src[key];\n\t\t} catch (e) {\n\t\t\tif (!error) error = e;\n\t\t}\n\t};\n\tfor (i = 1; i < length; ++i) {\n\t\tsrc = arguments[i];\n\t\tkeys(src).forEach(assign);\n\t}\n\tif (error !== undefined) throw error;\n\treturn dest;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? Object.keys : require(\"./shim\");\n","\"use strict\";\n\nmodule.exports = function () {\n\ttry {\n\t\tObject.keys(\"primitive\");\n\t\treturn true;\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n","\"use strict\";\n\nvar isValue = require(\"../is-value\");\n\nvar keys = Object.keys;\n\nmodule.exports = function (object) { return keys(isValue(object) ? Object(object) : object); };\n","\"use strict\";\n\n// eslint-disable-next-line no-empty-function\nmodule.exports = function () {};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nmodule.exports = function (value) {\n\tif (!isValue(value)) throw new TypeError(\"Cannot use null or undefined\");\n\treturn value;\n};\n","\"use strict\";\n\nvar isValue = require(\"./is-value\");\n\nvar forEach = Array.prototype.forEach, create = Object.create;\n\nvar process = function (src, obj) {\n\tvar key;\n\tfor (key in src) obj[key] = src[key];\n};\n\n// eslint-disable-next-line no-unused-vars\nmodule.exports = function (opts1 /*, …options*/) {\n\tvar result = create(null);\n\tforEach.call(arguments, function (options) {\n\t\tif (!isValue(options)) return;\n\t\tprocess(Object(options), result);\n\t});\n\treturn result;\n};\n","\"use strict\";\n\nmodule.exports = require(\"./is-implemented\")() ? String.prototype.contains : require(\"./shim\");\n","\"use strict\";\n\nvar str = \"razdwatrzy\";\n\nmodule.exports = function () {\n\tif (typeof str.contains !== \"function\") return false;\n\treturn str.contains(\"dwa\") === true && str.contains(\"foo\") === false;\n};\n","\"use strict\";\n\nvar indexOf = String.prototype.indexOf;\n\nmodule.exports = function (searchString /*, position*/) {\n\treturn indexOf.call(this, searchString, arguments[1]) > -1;\n};\n","\"use strict\";\n\nmodule.exports = function (fn) {\n\tif (typeof fn !== \"function\") throw new TypeError(fn + \" is not a function\");\n\treturn fn;\n};\n","const DEBUG = typeof window !== 'undefined' && window.location.href.indexOf('danmu-debug') > -1\n\nclass Logger {\n  constructor(constructorName) {\n    this.constructorName = constructorName || ''\n  }\n  info(message, ...optionalParams) {\n    DEBUG && console.log(`[Danmu Log][${this.constructorName}]`, message, ...optionalParams)\n  }\n}\n\nexport default Logger\n","import BaseClass from './baseClass'\nimport Main from './main'\nimport { createDom, hasOwnProperty } from './utils/util'\n\nclass Control extends BaseClass {\n  /**\n   * @param {import('./danmu').DanmuJs} danmu\n   */\n  constructor(danmu) {\n    super()\n    this.setLogger('control')\n    this.danmu = danmu\n    this.main = new Main(danmu)\n    if (!danmu.config.defaultOff) {\n      this.main.start()\n    }\n  }\n\n  createSwitch(state = true) {\n    this.logger && this.logger.info('createSwitch')\n    this.switchBtn = createDom(\n      'dk-switch',\n      '<span class=\"txt\">弹</span>',\n      {},\n      `danmu-switch ${state ? 'danmu-switch-active' : ''}`\n    )\n    return this.switchBtn\n  }\n\n  destroy() {\n    this.logger && this.logger.info('destroy')\n    this.main.destroy()\n    for (const k in this) {\n      if (hasOwnProperty.call(this, k)) {\n        delete this[k]\n      }\n    }\n  }\n}\n\nexport default Control\n","import BaseClass from './baseClass'\nimport Bullet from './bullet'\nimport Channel from './channel'\nimport { attachEventListener, hasOwnProperty } from './utils/util'\n\n// 单次尝试入轨弹幕数量越多，长任务及CPU耗时越多\nconst MAX_TRY_COUNT = 2\n\n/**\n * @typedef {{\n *  id: string\n *  start: number\n *  duration: number\n *  prior: boolean\n *  txt: string\n *  mode: 'scroll' | 'top' | 'bottom'\n *  attached_: boolean // 内部属性，标记弹幕是否已经被入轨\n * }} CommentData\n */\n\n/**\n * [Main 弹幕主进程]\n * @type {Class}\n */\nclass Main extends BaseClass {\n  /**\n   * @param {import('./danmu').DanmuJs} danmu\n   */\n  constructor(danmu) {\n    super()\n    this.setLogger('main')\n    this.danmu = danmu\n    this.container = danmu.container\n    this.channel = new Channel(danmu) // 弹幕轨道实例\n\n    /**\n     * @type {Array<CommentData>}\n     */\n    this.data = [].concat(danmu.config.comments)\n    this.playedData = []\n\n    /**\n     * @type {Array<Bullet>}\n     */\n    this.queue = [] // 等待播放的弹幕队列\n    this.timer = null // 弹幕动画定时器句柄\n\n    /**\n     * 弹幕播放速率\n     * @type {number}\n     */\n    this.playRate = 1\n\n    /**\n     * @type {'normal'|'stop'}\n     */\n    this.retryStatus = 'normal'\n    this.interval = danmu.config.interval // 弹幕队列缓存间隔\n    /**\n     * @type {Array<string>}\n     */\n    this.willChanges = []\n    /**\n     * @type {'idle' | 'paused' | 'playing' | 'closed'}\n     */\n    this._status = 'idle' // 当前弹幕正在闲置\n\n    attachEventListener(danmu, 'bullet_remove', this.updateQueue.bind(this), 'destroy')\n    attachEventListener(\n      danmu,\n      'changeDirection',\n      (direction) => {\n        this.danmu.direction = direction\n      },\n      'destroy'\n    )\n    this.nums = 0\n  }\n\n  get status() {\n    return this._status\n  }\n\n  /**\n   * @private\n   */\n  _cancelDataHandleTimer() {\n    if (this.handleId) {\n      clearTimeout(this.handleId)\n      this.handleId = null\n    }\n\n    if (this.handleTimer) {\n      clearTimeout(this.handleTimer)\n      this.handleTimer = null\n    }\n  }\n\n  destroy() {\n    this.logger && this.logger.info('destroy')\n    this._cancelDataHandleTimer()\n    this.channel.destroy()\n    this.data = []\n    for (let k in this) {\n      delete this[k]\n    }\n  }\n  // 在渲染队列中移除已经展示完的弹幕对象\n  updateQueue(rdata) {\n    this.logger && this.logger.info('updateQueue')\n    let self = this\n    self.queue.some((item, index) => {\n      if (item.id === rdata.bullet.id) {\n        self.queue.splice(index, 1)\n        return true\n      } else {\n        return false\n      }\n    })\n    self.data.some((item) => {\n      if (item.id === rdata.bullet.id) {\n        item.attached_ = false\n        return true\n      } else {\n        return false\n      }\n    })\n  }\n  init() {\n    const self = this\n    self.logger && self.logger.info('init')\n    self.retryStatus = 'normal'\n\n    self.sortData()\n\n    function dataHandle() {\n      if (self._status === 'closed' && self.retryStatus === 'stop') {\n        self._cancelDataHandleTimer()\n        return\n      }\n      if (self._status === 'playing') {\n        self.readData()\n        self.dataHandle()\n      }\n      if (self.retryStatus !== 'stop' || self._status === 'paused') {\n        self.handleTimer = setTimeout(() => {\n          // 在下一帧开始时进行绘制，最大程度减少卡顿\n          self.handleId = requestAnimationFrame(() => {\n            dataHandle()\n          })\n        }, 250)\n      }\n    }\n    dataHandle()\n  }\n  // 启动弹幕渲染主进程\n  start() {\n    this.logger && this.logger.info('start')\n    const self = this\n    self._status = 'playing'\n    self.queue = []\n    self.container.innerHTML = ''\n    self.channel.reset()\n    self.init()\n  }\n  stop() {\n    this.logger && this.logger.info('stop')\n    const self = this\n    self._status = 'closed'\n    self.retryStatus = 'stop'\n    self.queue = []\n    self.container.innerHTML = ''\n    self.channel.reset()\n  }\n  clear() {\n    this.logger && this.logger.info('clear')\n    this.channel.reset()\n    this.data = []\n    this.queue = []\n    this.container.innerHTML = ''\n  }\n  play() {\n    if (this._status === 'closed') {\n      this.logger && this.logger.info('play ignored')\n      return\n    }\n\n    this.logger && this.logger.info('play')\n    this._status = 'playing'\n    let channels = this.channel.channels\n    if (channels && channels.length > 0) {\n      // eslint-disable-next-line no-extra-semi\n      ;['scroll', 'top', 'bottom'].forEach((key) => {\n        // for (let i = 0; i < channels.length; i++) {\n        //   channels[i].queue[key].forEach(item => {\n        //     if(!item.resized) {\n        //       item.startMove()\n        //       item.resized = true\n        //     }\n        //   })\n        // }\n        this.queue.forEach((item) => {\n          item.startMove()\n          item.resized = true\n        })\n        for (let i = 0; i < channels.length; i++) {\n          channels[i].queue[key].forEach((item) => {\n            item.resized = false\n          })\n        }\n      })\n    }\n  }\n  pause() {\n    if (this._status === 'closed') {\n      this.logger && this.logger.info('pause ignored')\n      return\n    }\n\n    this.logger && this.logger.info('pause')\n    this._status = 'paused'\n    let channels = this.channel.channels\n    if (channels && channels.length > 0) {\n      // ['scroll', 'top', 'bottom'].forEach( key => {\n      //   for (let i = 0; i < channels.length; i++) {\n      //     channels[i].queue[key].forEach(item => {\n      //       item.pauseMove()\n      //     })\n      //   }\n      // })\n      this.queue.forEach((item) => {\n        item.pauseMove()\n      })\n    }\n  }\n  dataHandle() {\n    const self = this\n    if (this._status === 'paused' || this._status === 'closed') {\n      return\n    }\n    if (self.queue.length) {\n      self.queue.forEach((item) => {\n        if (item.status === 'waiting') {\n          item.startMove()\n        }\n      })\n    }\n  }\n  readData() {\n    if (!this.danmu.isReady) return\n\n    const self = this,\n      danmu = this.danmu,\n      player = danmu.player,\n      interval = self.interval,\n      channel = self.channel\n    let result,\n      /**\n       * @type {Bullet}\n       */\n      bullet,\n      /**\n       * @type {Array<CommentData>}\n       */\n      list\n\n    if (player) {\n      const currentTime = player.currentTime ? Math.floor(player.currentTime * 1000) : 0\n\n      list = self.data.filter((item) => {\n        if (!item.start && self.danmu.hideArr.indexOf(item.mode) < 0) {\n          if (!item.color || self.danmu.hideArr.indexOf('color') < 0) {\n            item.start = currentTime\n          }\n        }\n        return (\n          !item.attached_ &&\n          self.danmu.hideArr.indexOf(item.mode) < 0 &&\n          (!item.color || self.danmu.hideArr.indexOf('color') < 0) &&\n          item.start - interval <= currentTime &&\n          currentTime <= item.start + interval\n        )\n      })\n      if (danmu.live) {\n        self.data = []\n      }\n    } else {\n      list = self.data.splice(0, 1)\n      if (list.length === 0) list = self.playedData.splice(0, 1)\n    }\n\n    if (list.length > 0) {\n      // 提前更新轨道位置信息, 减少Bullet频繁读取容器dom信息\n      channel.updatePos()\n\n      let tryCount = MAX_TRY_COUNT\n\n      ListLoop: for (let i = 0, item; i < list.length; i++) {\n        item = list[i]\n        if (self.forceDuration && self.forceDuration != item.duration) {\n          item.duration = self.forceDuration\n        }\n        bullet = new Bullet(danmu, item)\n        if (bullet && !bullet.bulletCreateFail) {\n          bullet.attach()\n          item.attached_ = true\n          result = channel.addBullet(bullet)\n\n          if (result.result) {\n            self.queue.push(bullet)\n            self.nums++\n            bullet.topInit()\n\n            tryCount = MAX_TRY_COUNT\n          } else {\n            bullet.detach()\n            for (let k in bullet) {\n              if (hasOwnProperty.call(bullet, k)) {\n                delete bullet[k]\n              }\n            }\n            bullet = null\n            item.attached_ = false\n            if (item.noDiscard) {\n              if (item.prior) {\n                self.data.unshift(item)\n              } else {\n                self.data.push(item)\n              }\n            }\n\n            if (tryCount === 0) {\n              break ListLoop\n            } else {\n              tryCount--\n            }\n          }\n        } else {\n          if (tryCount === 0) {\n            break ListLoop\n          } else {\n            tryCount--\n          }\n        }\n      }\n    }\n  }\n  sortData() {\n    this.data.sort((prev, cur) => (prev.start || -1) - (cur.start || -1))\n  }\n}\n\nexport default Main\n","import BaseClass from './baseClass'\nimport { copyDom, isNumber, styleUtil } from './utils/util'\n\n/**\n * [Bullet 弹幕构造类]\n */\nexport class Bullet extends BaseClass {\n  /**\n   * @param {import('./danmu').DanmuJs} danmu\n   */\n  constructor(danmu, options) {\n    super()\n    // this.logger && this.logger.info('options.moveV', options.moveV)\n    const self = this\n\n    /**\n     * @type {HTMLElement}\n     */\n    let el\n\n    this.setLogger('bullet')\n    this.danmu = danmu\n    this.options = options\n    this.duration = options.duration\n    this.id = options.id\n    this.container = danmu.container\n    this.start = options.start\n    this.prior = options.prior\n    this.realTime = options.realTime\n    this.color = options.color\n    this.bookChannelId = options.bookChannelId\n    this.direction = danmu.direction\n    this.reuseDOM = true\n    this.willChanges = []\n    this.domObj = danmu.domObj\n\n    if (options.el && options.el.nodeType === 1) {\n      if (options.el.parentNode) return { bulletCreateFail: true }\n      if (danmu.config.disableCopyDOM) {\n        el = options.el\n        this.reuseDOM = false\n      } else {\n        el = this.domObj.use()\n        let copyDOM = copyDom(options.el)\n        if (options.eventListeners && options.eventListeners.length > 0) {\n          options.eventListeners.forEach((eventListener) => {\n            copyDOM.addEventListener(eventListener.event, eventListener.listener, eventListener.useCapture || false)\n          })\n        }\n        el.appendChild(copyDOM)\n      }\n      // el = copyDom(options.el)\n    } else {\n      el = this.domObj.use()\n      // el = document.createElement('div')\n      el.textContent = options.txt\n    }\n    this.onChangeDirection = (direction) => {\n      self.direction = direction\n    }\n    this.danmu.on('changeDirection', this.onChangeDirection)\n    if (options.style) {\n      let style = options.style\n      Object.keys(style).forEach(function (key) {\n        styleUtil(el, key, style[key])\n      })\n    }\n    if (options.mode === 'top' || options.mode === 'bottom') {\n      this.mode = options.mode\n    } else {\n      this.mode = 'scroll'\n    }\n\n    /**\n     * @type {HTMLElement}\n     */\n    this.el = el\n    if (options.like && options.like.el) {\n      this.setLikeDom(options.like.el, options.like.style)\n    }\n    this.status = 'waiting' // waiting,start,end\n\n    let offset\n    if (isNumber(danmu.config.bulletOffset) && danmu.config.bulletOffset >= 0) {\n      offset = danmu.config.bulletOffset\n    } else {\n      const containerPos = danmu.containerPos\n      offset = containerPos.width / 10 > 100 ? 100 : containerPos.width / 10\n    }\n    const random = options.realTime ? 0 : Math.floor(Math.random() * offset)\n\n    this.updateOffset(random)\n  }\n  get moveV() {\n    const self = this\n    let v = self._moveV\n\n    if (!v) {\n      if (self.options.moveV) {\n        v = self.options.moveV\n      } else {\n        if (self.elPos) {\n          const ctPos = self.danmu.containerPos\n          const distance = self.direction === 'b2t' ? ctPos.height + self.height : ctPos.width + self.width\n\n          v = (distance / self.duration) * 1000\n        }\n      }\n\n      if (v) {\n        v *= self.danmu.main.playRate\n\n        // 固化速度，否则resize时外部获取当前弹幕时会重新计算速度，导致布局异常（重叠），同时提高性能。\n        self._moveV = v\n      }\n    }\n    return v\n  }\n  updateOffset(val) {\n    this.random = val\n    styleUtil(this.el, 'left', this.danmu.containerPos.width + val + 'px')\n  }\n  attach() {\n    // this.logger && this.logger.info(`attach #${this.options.txt || '[DOM Element]'}#`)\n    const self = this\n    const el = self.el\n\n    self.container.appendChild(el)\n    self.elPos = el.getBoundingClientRect()\n    if (self.direction === 'b2t') {\n      self.width = self.elPos.height\n      self.height = self.elPos.width\n    } else {\n      self.width = self.elPos.width\n      self.height = self.elPos.height\n    }\n    if (self.moveV) {\n      self.duration = ((self.danmu.containerPos.width + self.random + self.width) / self.moveV) * 1000\n    }\n    if (self.danmu.config) {\n      if (self.danmu.config.mouseControl) {\n        self.mouseoverFunWrapper = self.mouseoverFun.bind(self)\n        el.addEventListener('mouseover', self.mouseoverFunWrapper, false)\n      }\n      if (self.danmu.config.mouseEnterControl) {\n        self.mouseEnterFunWrapper = self.mouseoverFun.bind(self)\n        el.addEventListener('mouseenter', self.mouseEnterFunWrapper, false)\n      }\n    }\n\n    el.addEventListener('transitionend', self._onTransitionEnd, false)\n  }\n  detach() {\n    // this.logger && this.logger.info(`detach #${this.options.txt || '[DOM Element]'}#`)\n    const self = this\n    const el = self.el\n\n    if (el) {\n      let config = self.danmu.config\n      if (config) {\n        if (config.mouseControl) {\n          el.removeEventListener('mouseover', self.mouseoverFunWrapper, false)\n        }\n        if (config.mouseEnterControl) {\n          el.removeEventListener('mouseenter', self.mouseEnterFunWrapper, false)\n        }\n      }\n\n      el.removeEventListener('transitionend', self._onTransitionEnd, false)\n\n      if (el.parentNode) {\n        el.parentNode.removeChild(el)\n      }\n      if (self.reuseDOM) {\n        self.domObj.unused(el)\n      }\n      self.el = null\n    }\n\n    self.elPos = undefined\n    self.danmu.off('changeDirection', this.onChangeDirection)\n  }\n  willChange() {\n    let val = this.danmu.main.willChanges.concat(this.willChanges).join()\n    styleUtil(this.el, 'willChange', val)\n  }\n  mouseoverFun(event) {\n    let self = this\n    if (\n      (self.danmu && self.danmu.mouseControl && self.danmu.config.mouseControlPause) ||\n      self.status === 'waiting' ||\n      self.status === 'end'\n    ) {\n      return\n    }\n    self.danmu &&\n      self.danmu.emit('bullet_hover', {\n        bullet: self,\n        event: event\n      })\n  }\n  /**\n   * @private\n   */\n  _onTransitionEnd() {\n    this.status = 'end'\n    this.remove()\n  }\n  topInit() {\n    this.logger && this.logger.info(`topInit #${this.options.txt || '[DOM Element]'}#`)\n    if (this.direction === 'b2t') {\n      styleUtil(this.el, 'transformOrigin', 'left top')\n      styleUtil(\n        this.el,\n        'transform',\n        `translateX(-${this.top}px) translateY(${this.danmu.containerPos.height}px) translateZ(0px) rotate(90deg)`\n      )\n      styleUtil(this.el, 'transition', 'transform 0s linear 0s')\n    } else {\n      styleUtil(this.el, 'top', `${this.top}px`)\n    }\n  }\n  pauseMove(isFullscreen = false) {\n    // this.logger && this.logger.info(`pauseMove #${this.options.txt || '[DOM Element]'}#`)\n    const self = this\n    if (self.status === 'paused') {\n      return\n    }\n    if (self.status !== 'forcedPause') {\n      this.status = 'paused'\n    }\n\n    // 将记忆速度删除，以备通过接口调整速度或duration时重计速度\n    self._moveV = undefined\n\n    if (!this.el) {\n      return\n    }\n    this.willChange()\n    if (this.mode === 'scroll') {\n      const ctPos = self.danmu.containerPos\n      if (isFullscreen) {\n        let pastDuration = (new Date().getTime() - self.moveTime) / 1000\n        let pastS = pastDuration * this.moveV\n        let ratio = 0\n        let nowS = 0\n        if (self.moveMoreS - pastS >= 0) {\n          if (this.direction === 'b2t') {\n            ratio = (self.moveMoreS - pastS) / self.moveContainerHeight\n            nowS = ratio * ctPos.height\n          } else {\n            ratio = (self.moveMoreS - pastS) / self.moveContainerWidth\n            nowS = ratio * ctPos.width\n          }\n        } else {\n          nowS = self.moveMoreS - pastS\n        }\n        if (this.direction === 'b2t') {\n          styleUtil(\n            this.el,\n            'transform',\n            `translateX(-${this.top}px) translateY(${nowS}px) translateZ(0px) rotate(90deg)`\n          )\n        } else {\n          styleUtil(this.el, 'left', `${nowS}px`)\n        }\n      } else {\n        if (this.direction === 'b2t') {\n          styleUtil(\n            this.el,\n            'transform',\n            `translateX(-${this.top}px) translateY(${\n              this.el.getBoundingClientRect().top - ctPos.top\n            }px) translateZ(0px) rotate(90deg)`\n          )\n        } else {\n          styleUtil(this.el, 'left', `${this.el.getBoundingClientRect().left - ctPos.left}px`)\n        }\n      }\n      if (this.direction === 'b2t') {\n        // this.el.style.transform = `translateX(-${this.top}px) translateY(${nowS}px) translateZ(0px) rotate(90deg)`\n        styleUtil(this.el, 'transition', 'transform 0s linear 0s')\n      } else {\n        styleUtil(this.el, 'transform', 'translateX(0px) translateY(0px) translateZ(0px)')\n        styleUtil(this.el, 'transition', 'transform 0s linear 0s')\n      }\n    } else {\n      if (!this.pastDuration || !this.startTime) {\n        this.pastDuration = 1\n      } else {\n        this.pastDuration = this.pastDuration + new Date().getTime() - this.startTime\n      }\n    }\n  }\n  startMove(force) {\n    // this.logger && this.logger.info(`startMove #${this.options.txt || '[DOM Element]'}#`)\n    const self = this\n    if (!self.hasMove) {\n      self.danmu.emit('bullet_start', self)\n      self.hasMove = true\n    }\n    if (self.status === 'forcedPause' && !force) return\n    if (!this.el) return\n    if (this.status === 'start') return\n\n    this.status = 'start'\n    this.willChanges = ['transform', 'transition']\n    this.willChange()\n    styleUtil(this.el, 'backface-visibility', 'hidden')\n    styleUtil(this.el, 'perspective', '500em')\n\n    if (this.mode === 'scroll') {\n      const ctPos = self.danmu.containerPos\n\n      if (this.direction === 'b2t') {\n        let leftDuration = (self.el.getBoundingClientRect().bottom - ctPos.top) / this.moveV\n        styleUtil(self.el, 'transition', `transform ${leftDuration}s linear 0s`)\n        styleUtil(\n          self.el,\n          'transform',\n          `translateX(-${self.top}px) translateY(-${self.height}px) translateZ(0px) rotate(90deg)`\n        )\n        self.moveTime = new Date().getTime()\n        self.moveMoreS = self.el.getBoundingClientRect().top - ctPos.top\n        self.moveContainerHeight = ctPos.height\n        // self.removeTimer = setTimeout(func, leftDuration * 1000)\n      } else {\n        if (!self.el) {\n          return\n        }\n        const bulletPos = self.el.getBoundingClientRect()\n        const leftDistance = bulletPos.right - ctPos.left\n        const leftDuration = leftDistance / self.moveV\n        // const v = leftDistance / leftDuration * self.danmu.main.playRate\n        // self.el.style.left = bulletPos.left + 'px'\n\n        if (bulletPos.right > ctPos.left) {\n          styleUtil(self.el, 'transition', `transform ${leftDuration}s linear 0s`)\n          styleUtil(self.el, 'transform', `translateX(-${leftDistance}px) translateY(0px) translateZ(0px)`)\n\n          self.moveTime = new Date().getTime()\n          self.moveMoreS = bulletPos.left - ctPos.left\n          self.moveContainerWidth = ctPos.width\n        } else {\n          self.status = 'end'\n          self.remove()\n        }\n      }\n    } else {\n      styleUtil(this.el, 'left', '50%')\n      styleUtil(this.el, 'margin', `0 0 0 -${this.width / 2}px`)\n      if (!this.pastDuration) {\n        this.pastDuration = 1\n      }\n      this.startTime = new Date().getTime()\n    }\n  }\n  remove() {\n    this.logger && this.logger.info(`remove #${this.options.txt || '[DOM Element]'}#`)\n    const self = this\n\n    self.pauseMove()\n\n    if (self.el && self.el.parentNode) {\n      this.willChanges = []\n      this.willChange()\n\n      self.detach()\n      if (this.options.el && this.options.el.nodeType === 1 && this.danmu.config.disableCopyDOM) {\n        styleUtil(this.options.el, 'transform', 'none')\n      }\n      self.danmu.emit('bullet_remove', {\n        bullet: self\n      })\n    }\n  }\n\n  setFontSize(size) {\n    if (this.el) {\n      this.el.style['fontSize'] = size\n    }\n  }\n  setLikeDom(el, style) {\n    if (el) {\n      Object.keys(style).forEach(function (key) {\n        el.style[key] = style[key]\n      })\n      let likeClass = 'danmu-like'\n      el.className = likeClass\n      if (this.el) {\n        let children = this.el.querySelector('.' + likeClass)\n        if (children) {\n          this.el.removeChild(children)\n        }\n        this.el.innerHTML = `${this.el.innerHTML}${el.outerHTML}`\n      }\n    }\n    return el\n  }\n}\n\nexport default Bullet\n","import BaseClass from './baseClass'\nimport { attachEventListener, hasOwnProperty, isNumber } from './utils/util'\nimport { validAreaLineRule } from './utils/validator'\n\n/**\n * [Channel 弹幕轨道控制]\n */\nclass Channel extends BaseClass {\n  /**\n   * @param {import('./danmu').DanmuJs} danmu\n   */\n  constructor(danmu) {\n    super()\n    const self = this\n\n    self.setLogger('channel')\n    self.danmu = danmu\n    self.reset(true)\n    self.direction = danmu.direction\n    self.channels = []\n    self.updatePos()\n\n    attachEventListener(\n      this.danmu,\n      'bullet_remove',\n      (r) => {\n        self.removeBullet(r.bullet)\n      },\n      'destroy'\n    )\n    attachEventListener(\n      this.danmu,\n      'changeDirection',\n      (direction) => {\n        self.direction = direction\n      },\n      'destroy'\n    )\n    attachEventListener(\n      this.danmu,\n      'channel_resize',\n      () => {\n        self.resize()\n      },\n      'destroy'\n    )\n  }\n  updatePos() {\n    const pos = this.container.getBoundingClientRect()\n\n    this.containerPos = pos\n    this.containerWidth = pos.width\n    this.containerHeight = pos.height\n    this.containerTop = pos.top\n    this.containerBottom = pos.bottom\n    this.containerLeft = pos.left\n    this.containerRight = pos.right\n  }\n  destroy() {\n    this.logger && this.logger.info('destroy')\n    this.channels.splice(0, this.channels.length)\n    this._cancelResizeTimer()\n\n    // clear prop at end\n    for (const k in this) {\n      if (hasOwnProperty.call(this, k)) {\n        delete this[k]\n      }\n    }\n  }\n\n  /**\n   * Feature:\n   * 1. 长弹幕速度较快，更容易出现追击问题，需要调整Offset\n   * 2. 需要按实时性RealTime展示的弹幕，则不能再用duration来计算速度，这样会产生追击重叠问题\n   *\n   * @param {import('./bullet').Bullet} bullet\n   */\n  addBullet(bullet) {\n    // this.logger && this.logger.info(`addBullet ${bullet.options.txt || '[DOM Element]'}`)\n    const self = this\n    const danmu = this.danmu\n    const channels = this.channels\n    let channelHeight, channelWidth, occupy\n\n    if (self.direction === 'b2t') {\n      channelWidth = this.channelWidth\n      occupy = Math.ceil(bullet.width / channelWidth)\n    } else {\n      channelHeight = this.channelHeight\n      occupy = Math.ceil(bullet.height / channelHeight)\n    }\n    if (occupy > channels.length) {\n      return {\n        result: false,\n        message: `exceed channels.length, occupy=${occupy},channelsSize=${channels.length}`\n      }\n    } else {\n      let flag = true,\n        channel,\n        pos = -1\n      for (let i = 0, max = channels.length; i < max; i++) {\n        if (channels[i].queue[bullet.mode].some((item) => item.id === bullet.id)) {\n          return {\n            result: false,\n            message: `exited, channelOrder=${i},danmu_id=${bullet.id}`\n          }\n        }\n      }\n      if (bullet.mode === 'scroll') {\n        for (let i = 0, max = channels.length - occupy; i <= max; i++) {\n          flag = true\n          for (let j = i; j < i + occupy; j++) {\n            channel = channels[j]\n            if (channel.operating.scroll) {\n              flag = false\n              break\n            }\n            if (channel.bookId.scroll && channel.bookId.scroll !== bullet.id) {\n              flag = false\n              break\n            }\n            channel.operating.scroll = true\n\n            // 当前轨道 - 最后入轨弹幕\n            const curBullet = channel.queue.scroll[0]\n\n            if (curBullet) {\n              const curBulletPos = curBullet.el.getBoundingClientRect()\n\n              // 1. 检测最后入轨弹幕是否已经完全飘入容器区域\n              if (self.direction === 'b2t') {\n                if (curBulletPos.bottom >= self.containerPos.bottom) {\n                  flag = false\n                  channel.operating.scroll = false\n                  break\n                }\n              } else {\n                if (curBulletPos.right >= self.containerPos.right) {\n                  flag = false\n                  channel.operating.scroll = false\n                  break\n                }\n              }\n\n              let curS,\n                curV = curBullet.moveV,\n                curT,\n                newV = bullet.moveV,\n                catchS\n              if (self.direction === 'b2t') {\n                curS = curBulletPos.bottom - self.containerTop\n                curT = curS / curV\n\n                catchS = self.containerHeight + bullet.random - curS\n              } else {\n                curS = curBulletPos.right - self.containerLeft\n                curT = curS / curV\n\n                catchS = self.containerWidth + bullet.random - curS\n              }\n\n              // 2. 当前轨道内，新弹幕速度大于最后一个入轨弹幕速度，考虑碰撞问题\n              if (newV > curV) {\n                let catchT = catchS / (newV - curV)\n\n                if (!danmu.config.bOffset) {\n                  danmu.config.bOffset = 0\n                }\n\n                // 3. 相遇时间小于最后弹幕飘出时间\n                if (curT + danmu.config.bOffset >= catchT) {\n                  // 根据前一个弹幕剩余飘出时间，计算新弹幕需要增加的offset\n                  const offset = curT * newV - self.containerPos.width\n                  if (offset > 0) {\n                    bullet.updateOffset(offset + (1 + Math.ceil(5 * Math.random())) /* 防止最后过于接近 */)\n                  }\n                }\n              }\n            }\n            channel.operating.scroll = false\n          }\n          if (flag) {\n            pos = i\n            break\n          }\n        }\n      } else if (bullet.mode === 'top') {\n        for (let i = 0, max = channels.length - occupy; i <= max; i++) {\n          flag = true\n          for (let j = i; j < i + occupy; j++) {\n            if (j > Math.floor(channels.length / 2)) {\n              flag = false\n              break\n            }\n            channel = channels[j]\n            if (channel.operating[bullet.mode]) {\n              flag = false\n              break\n            }\n            if ((channel.bookId[bullet.mode] || bullet.prior) && channel.bookId[bullet.mode] !== bullet.id) {\n              flag = false\n              break\n            }\n            channel.operating[bullet.mode] = true\n            if (channel.queue[bullet.mode].length > 0) {\n              flag = false\n              channel.operating[bullet.mode] = false\n              break\n            }\n            channel.operating[bullet.mode] = false\n          }\n          if (flag) {\n            pos = i\n            break\n          }\n        }\n      } else if (bullet.mode === 'bottom') {\n        for (let i = channels.length - occupy; i >= 0; i--) {\n          flag = true\n          for (let j = i; j < i + occupy; j++) {\n            if (j <= Math.floor(channels.length / 2)) {\n              flag = false\n              break\n            }\n            channel = channels[j]\n            if (channel.operating[bullet.mode]) {\n              flag = false\n              break\n            }\n            if ((channel.bookId[bullet.mode] || bullet.prior) && channel.bookId[bullet.mode] !== bullet.id) {\n              flag = false\n              break\n            }\n            channel.operating[bullet.mode] = true\n            if (channel.queue[bullet.mode].length > 0) {\n              flag = false\n              channel.operating[bullet.mode] = false\n              break\n            }\n            channel.operating[bullet.mode] = false\n          }\n          if (flag) {\n            pos = i\n            break\n          }\n        }\n      }\n\n      if (pos !== -1) {\n        for (let i = pos, max = pos + occupy; i < max; i++) {\n          channel = channels[i]\n          channel.operating[bullet.mode] = true\n          channel.queue[bullet.mode].unshift(bullet)\n          if (bullet.prior) {\n            delete channel.bookId[bullet.mode]\n            self.logger && self.logger.info(i + '号轨道恢复正常使用')\n          }\n          channel.operating[bullet.mode] = false\n        }\n        if (bullet.prior) {\n          self.logger && self.logger.info(bullet.id + '号优先弹幕运行完毕')\n          delete bullet['bookChannelId']\n          if (danmu.player) {\n            let dataList = danmu.bulletBtn.main.data\n            dataList.some(function (item) {\n              if (item.id === bullet.id) {\n                delete item['bookChannelId']\n                return true\n              } else {\n                return false\n              }\n            })\n          }\n        }\n        bullet.channel_id = [pos, occupy]\n\n        if (self.direction === 'b2t') {\n          bullet.top = pos * channelWidth\n          if (self.danmu.config.area && self.danmu.config.area.start) {\n            bullet.top += self.containerWidth * self.danmu.config.area.start\n          }\n        } else {\n          bullet.top = pos * channelHeight\n          if (self.danmu.config.area && self.danmu.config.area.start) {\n            bullet.top += self.containerHeight * self.danmu.config.area.start\n          }\n        }\n        return {\n          result: bullet,\n          message: 'success'\n        }\n      } else {\n        if (bullet.options.realTime) {\n          // 找到应该被删的 danmu\n          let start = 0\n          let deleteIndex = -1\n          let deleteItem = null\n          self.danmu.bulletBtn.main.queue.forEach((item, index) => {\n            if (\n              !item.prior &&\n              !item.options.realTime &&\n              item.el &&\n              item.el.getBoundingClientRect().left > self.containerPos.right &&\n              item.start >= start\n            ) {\n              start = item.start\n              deleteIndex = index\n              deleteItem = item\n            }\n          })\n          if (deleteItem) {\n            deleteItem.remove()\n            self.removeBullet(deleteItem)\n            self.danmu.bulletBtn.main.queue.splice(deleteIndex, 1)\n            bullet.channel_id = deleteItem.channel_id\n            for (\n              let i = deleteItem.channel_id[0], max = deleteItem.channel_id[0] + deleteItem.channel_id[1];\n              i < max;\n              i++\n            ) {\n              channel = channels[i]\n              channel.operating[bullet.mode] = true\n              channel.queue[bullet.mode].unshift(bullet)\n              if (bullet.prior) {\n                delete channel.bookId[bullet.mode]\n              }\n              channel.operating[bullet.mode] = false\n            }\n            bullet.top = deleteItem.top\n            if (self.danmu.config.area && self.danmu.config.area.start) {\n              bullet.top += self.containerHeight * self.danmu.config.area.start\n            }\n            return {\n              result: bullet,\n              message: 'success'\n            }\n          }\n        }\n\n        if (bullet.prior) {\n          if (!bullet.bookChannelId && !self.danmu.live) {\n            pos = -1\n            for (let i = 0, max = channels.length - occupy; i <= max; i++) {\n              flag = true\n              for (let j = i; j < i + occupy; j++) {\n                if (channels[j].bookId[bullet.mode]) {\n                  flag = false\n                  break\n                }\n              }\n              if (flag) {\n                pos = i\n                break\n              }\n            }\n            if (pos !== -1) {\n              for (let j = pos; j < pos + occupy; j++) {\n                channels[j].bookId[bullet.mode] = bullet.id\n                self.logger && self.logger.info(j + '号轨道被' + bullet.id + '号优先弹幕预定')\n              }\n              let nextAddTime = 2\n              if (danmu.player) {\n                let dataList = danmu.bulletBtn.main.data\n                dataList.some(function (item) {\n                  if (item.id === bullet.id) {\n                    self.logger && self.logger.info(bullet.id + '号优先弹幕将于' + nextAddTime + '秒后再次请求注册')\n                    item.start += nextAddTime * 1000\n                    item.bookChannelId = [pos, occupy]\n                    self.logger && self.logger.info(`${bullet.id}号优先弹幕预定了${pos}~${pos + occupy - 1}号轨道`)\n                    return true\n                  } else {\n                    return false\n                  }\n                })\n              }\n            }\n          } else {\n            let nextAddTime = 2\n            if (danmu.player) {\n              let dataList = danmu.bulletBtn.main.data\n              dataList.some(function (item) {\n                if (item.id === bullet.id) {\n                  self.logger && self.logger.info(bullet.id + '号优先弹幕将于' + nextAddTime + '秒后再次请求注册')\n                  item.start += nextAddTime * 1000\n                  return true\n                } else {\n                  return false\n                }\n              })\n            }\n          }\n        }\n\n        return {\n          result: false,\n          message: 'no surplus will right'\n        }\n      }\n    }\n  }\n  removeBullet(bullet) {\n    this.logger && this.logger.info(`removeBullet ${bullet.options.txt || '[DOM Element]'}`)\n\n    let channels = this.channels\n    let channelId = bullet.channel_id\n    let channel\n    for (let i = channelId[0], max = channelId[0] + channelId[1]; i < max; i++) {\n      channel = channels[i]\n      if (channel) {\n        channel.operating[bullet.mode] = true\n        let i = -1\n        channel.queue[bullet.mode].some((item, index) => {\n          if (item.id === bullet.id) {\n            i = index\n            return true\n          } else {\n            return false\n          }\n        })\n        if (i > -1) {\n          channel.queue[bullet.mode].splice(i, 1)\n        }\n        channel.operating[bullet.mode] = false\n      }\n    }\n    if (bullet.options.loop) {\n      this.danmu.bulletBtn.main.playedData.push(bullet.options)\n    }\n  }\n\n  resizeSync() {\n    this.resize(true)\n  }\n\n  resize(sync = false) {\n    this.logger && this.logger.info('resize')\n    let self = this\n    if (self.resizing) {\n      return\n    }\n    self.resizing = true\n\n    function layout() {\n      const { container, config, bulletBtn } = self.danmu\n      let channelCount\n\n      self.updatePos()\n      self._cancelResizeTimer()\n\n      if (bulletBtn.main.data) {\n        bulletBtn.main.data.forEach((item) => {\n          if (item.bookChannelId) {\n            delete item['bookChannelId']\n            self.logger && self.logger.info('resize导致' + item.id + '号优先弹幕预定取消')\n          }\n        })\n      }\n      self.logger && self.logger.info('resize导致所有轨道恢复正常使用')\n      self.width = self.containerWidth\n      self.height = self.containerHeight\n\n      if (config.area) {\n        const { lines, start, end } = config.area\n        if (validAreaLineRule(lines)) {\n          channelCount = lines\n        } else {\n          if (start >= 0 && end >= start) {\n            if (self.direction === 'b2t') {\n              self.width = self.width * (end - start)\n            } else {\n              self.height = self.height * (end - start)\n            }\n          }\n        }\n      }\n      self.container = container\n      let fontSize = config.channelSize || (/mobile/gi.test(navigator.userAgent) ? 10 : 12)\n\n      if (!isNumber(channelCount)) {\n        if (self.direction === 'b2t') {\n          channelCount = Math.floor(self.width / fontSize)\n        } else {\n          channelCount = Math.floor(self.height / fontSize)\n        }\n      }\n\n      let channels = []\n      for (let i = 0; i < channelCount; i++) {\n        channels[i] = {\n          id: i,\n          queue: {\n            scroll: [],\n            top: [],\n            bottom: []\n          },\n          operating: {\n            scroll: false,\n            top: false,\n            bottom: false\n          },\n          bookId: {}\n        }\n      }\n      if (self.channels && self.channels.length <= channels.length) {\n        for (let i = 0; i < self.channels.length; i++) {\n          channels[i] = {\n            id: i,\n            queue: {\n              scroll: [],\n              top: [],\n              bottom: []\n            },\n            operating: {\n              scroll: false,\n              top: false,\n              bottom: false\n            },\n            bookId: {}\n          }\n          ;['scroll', 'top'].forEach((key) => {\n            self.channels[i].queue[key].forEach((item) => {\n              if (item.el) {\n                channels[i].queue[key].push(item)\n                // if (!item.resized) {\n                //   item.pauseMove(isFullscreen)\n                //   if (item.danmu.bulletBtn.main.status !== 'paused') {\n                //     item.startMove(false, sync)\n                //   }\n                //   item.resized = true\n                // }\n              }\n            })\n          })\n          self.channels[i].queue['bottom'].forEach((item) => {\n            if (item.el) {\n              channels[i + channels.length - self.channels.length].queue['bottom'].push(item)\n              if (item.channel_id[0] + item.channel_id[1] - 1 === i) {\n                let channel_id = [].concat(item.channel_id)\n                item.channel_id = [channel_id[0] - self.channels.length + channels.length, channel_id[1]]\n                item.top = item.channel_id[0] * fontSize\n                if (self.danmu.config.area && self.danmu.config.area.start) {\n                  item.top += self.containerHeight * self.danmu.config.area.start\n                }\n                item.topInit()\n              }\n              //   if (!item.resized) {\n              //     item.pauseMove(isFullscreen)\n              //     if (item.danmu.bulletBtn.main.status !== 'paused') {\n              //       item.startMove(false, sync)\n              //     }\n              //     item.resized = true\n              //   }\n            }\n          })\n        }\n        for (let i = 0; i < channels.length; i++) {\n          // eslint-disable-next-line no-extra-semi\n          ;['scroll', 'top', 'bottom'].forEach((key) => {\n            channels[i].queue[key].forEach((item) => {\n              item.resized = false\n            })\n          })\n        }\n        self.channels = channels\n        if (self.direction === 'b2t') {\n          self.channelWidth = fontSize\n        } else {\n          self.channelHeight = fontSize\n        }\n      } else if (self.channels && self.channels.length > channels.length) {\n        for (let i = 0; i < channels.length; i++) {\n          channels[i] = {\n            id: i,\n            queue: {\n              scroll: [],\n              top: [],\n              bottom: []\n            },\n            operating: {\n              scroll: false,\n              top: false,\n              bottom: false\n            },\n            bookId: {}\n          }\n          ;['scroll', 'top', 'bottom'].forEach((key) => {\n            if (key === 'top' && i > Math.floor(channels.length / 2)) {\n              //\n            } else if (key === 'bottom' && i <= Math.floor(channels.length / 2)) {\n              //\n            } else {\n              let num = key === 'bottom' ? i - channels.length + self.channels.length : i\n              self.channels[num].queue[key].forEach((item, index) => {\n                if (item.el) {\n                  channels[i].queue[key].push(item)\n                  if (key === 'bottom') {\n                    if (item.channel_id[0] + item.channel_id[1] - 1 === num) {\n                      let channel_id = [].concat(item.channel_id)\n                      item.channel_id = [channel_id[0] - self.channels.length + channels.length, channel_id[1]]\n                      item.top = item.channel_id[0] * fontSize\n                      if (self.danmu.config.area && self.danmu.config.area.start) {\n                        item.top += self.containerHeight * self.danmu.config.area.start\n                      }\n                      item.topInit()\n                    }\n                  }\n                  //   item.pauseMove(isFullscreen)\n                  //   if (item.danmu.bulletBtn.main.status !== 'paused') {\n                  //     item.startMove(false, sync)\n                  //   }\n                  //   if (!item.resized) {\n                  //     item.resized = true\n                  //   }\n                }\n                self.channels[num].queue[key].splice(index, 1)\n              })\n            }\n          })\n        }\n        // for (let i = channels.length; i < self.channels.length; i++) {\n        //   ['scroll', 'top', 'bottom'].forEach(key => {\n        //     self.channels[i].queue[key].forEach(item => {\n        //       item.remove()\n        //     })\n        //   })\n        // }\n        for (let i = 0; i < channels.length; i++) {\n          // eslint-disable-next-line no-extra-semi\n          ;['scroll', 'top', 'bottom'].forEach((key) => {\n            channels[i].queue[key].forEach((item) => {\n              item.resized = false\n            })\n          })\n        }\n        self.channels = channels\n\n        if (self.direction === 'b2t') {\n          self.channelWidth = fontSize\n        } else {\n          self.channelHeight = fontSize\n        }\n      }\n      self.resizing = false\n    }\n\n    if (sync) {\n      layout()\n    } else {\n      this._cancelResizeTimer()\n      this.resizeId = requestAnimationFrame(layout)\n    }\n  }\n\n  /**\n   * @private\n   */\n  _cancelResizeTimer() {\n    if (this.resizeId) {\n      cancelAnimationFrame(this.resizeId)\n      this.resizeId = null\n    }\n  }\n\n  reset(isInit = false) {\n    this.logger && this.logger.info('reset')\n    const self = this\n    const { container, bulletBtn, config } = self.danmu\n\n    self.container = container\n\n    // bullet on waiting room\n    if (bulletBtn && bulletBtn.main) {\n      bulletBtn.main.queue.forEach((item) => {\n        item.remove()\n      })\n    }\n    // bullet on track\n    if (self.channels && self.channels.length > 0) {\n      // eslint-disable-next-line no-extra-semi\n      ;['scroll', 'top', 'bottom'].forEach((key) => {\n        for (let i = 0; i < self.channels.length; i++) {\n          self.channels[i].queue[key].forEach((item) => {\n            item.remove()\n          })\n        }\n      })\n    }\n    if (bulletBtn && bulletBtn.main && bulletBtn.main.data) {\n      bulletBtn.main.data.forEach((item) => {\n        item.attached_ = false\n      })\n    }\n\n    function channelReset() {\n      let channelCount\n      let size = container.getBoundingClientRect()\n      self.width = size.width\n      self.height = size.height\n\n      if (self.resetId) {\n        cancelAnimationFrame(self.resetId)\n        self.resetId = null\n      }\n\n      if (config.area) {\n        const { lines, start, end } = config.area\n        if (validAreaLineRule(lines)) {\n          channelCount = lines\n        } else {\n          if (start >= 0 && end >= start) {\n            if (self.direction === 'b2t') {\n              self.width = self.width * (end - start)\n            } else {\n              self.height = self.height * (end - start)\n            }\n          }\n        }\n      }\n      let fontSize = config.channelSize || (/mobile/gi.test(navigator.userAgent) ? 10 : 12)\n\n      if (!isNumber(channelCount)) {\n        if (self.direction === 'b2t') {\n          channelCount = Math.floor(self.width / fontSize)\n        } else {\n          channelCount = Math.floor(self.height / fontSize)\n        }\n      }\n\n      let channels = []\n      for (let i = 0; i < channelCount; i++) {\n        channels[i] = {\n          id: i,\n          queue: {\n            scroll: [],\n            top: [],\n            bottom: []\n          },\n          operating: {\n            scroll: false,\n            top: false,\n            bottom: false\n          },\n          bookId: {}\n        }\n      }\n      self.channels = channels\n      if (self.direction === 'b2t') {\n        self.channelWidth = fontSize\n      } else {\n        self.channelHeight = fontSize\n      }\n    }\n\n    if (isInit) {\n      this.resetId = requestAnimationFrame(channelReset)\n    } else {\n      channelReset()\n    }\n  }\n}\n\nexport default Channel\n","export function validAreaLineRule(line) {\n  return typeof line === 'number' && line >= 0 && Number.isInteger(line)\n}\n","import { hasOwnProperty, styleUtil } from './utils/util'\n\nexport default class RecyclableDOMList {\n  constructor(options) {\n    options = {\n      initDOM: () => document.createElement('div'),\n      initSize: 10\n    }\n    this.init(options)\n  }\n\n  init(options) {\n    this.idleList = []\n    this.usingList = []\n    this._id = 0\n    this.options = options\n    this._expand(options.initSize)\n  }\n\n  use() {\n    if (!this.idleList.length) {\n      this._expand(1)\n    }\n    const firseIdle = this.idleList.shift()\n    this.usingList.push(firseIdle)\n    return firseIdle\n  }\n\n  unused(dom) {\n    const idx = this.usingList.indexOf(dom)\n    if (idx < 0) {\n      return\n    }\n    this.usingList.splice(idx, 1)\n    dom.innerHTML = ''\n    dom.textcontent = ''\n    this.clearElementStyle(dom)\n    this.idleList.push(dom)\n  }\n\n  _expand(size) {\n    for (let i = 0; i < size; i++) {\n      this.idleList.push(this.options.initDOM(this._id++))\n    }\n  }\n\n  destroy() {\n    for (let i = 0; i < this.idleList.length; i++) {\n      this.idleList[i].innerHTML = ''\n      this.idleList[i].textcontent = ''\n      this.clearElementStyle(this.idleList[i])\n    }\n    for (let i = 0; i < this.usingList.length; i++) {\n      this.usingList[i].innerHTML = ''\n      this.usingList[i].textcontent = ''\n      this.clearElementStyle(this.usingList[i])\n    }\n    for (let k in this) {\n      if (hasOwnProperty.call(this, k)) {\n        delete this[k]\n      }\n    }\n  }\n\n  clearElementStyle(element) {\n    const ua = typeof window !== 'undefined' ? window.navigator.userAgent : null\n    if (!ua) {\n      return\n    }\n    if (ua.indexOf('MSIE ') > -1 || ua.indexOf('Trident/') > -1) {\n      styleUtil(element, 'transform', 'none')\n    } else {\n      element.setAttribute('style', '')\n    }\n  }\n}\n","import { throttle } from './utils/util'\n\nclass ResizeObserver {\n  constructor() {\n    this.__handlers = []\n    if (!window.ResizeObserver) {\n      return\n    }\n    try {\n      this.observer = new window.ResizeObserver(\n        throttle((entries) => {\n          this.__trigger(entries)\n        }, 100)\n      )\n      // eslint-disable-next-line no-empty\n    } catch (err) {}\n  }\n\n  addObserver(target, handler) {\n    if (!this.observer) {\n      return\n    }\n    this.observer && this.observer.observe(target)\n    const { __handlers } = this\n    let index = -1\n    for (let i = 0; i < __handlers.length; i++) {\n      if (__handlers[i] && target === __handlers[i].target) {\n        index = i\n      }\n    }\n    if (index > -1) {\n      this.__handlers[index].handler.push(handler)\n    } else {\n      this.__handlers.push({\n        target,\n        handler: [handler]\n      })\n    }\n  }\n\n  unObserver(target) {\n    let i = -1\n    this.__handlers.map((item, index) => {\n      if (target === item.target) {\n        i = index\n      }\n    })\n    this.observer && this.observer.unobserve(target)\n    i > -1 && this.__handlers.splice(i, 1)\n  }\n\n  destroyObserver() {\n    this.observer && this.observer.disconnect()\n    this.observer = null\n    this.__handlers = null\n  }\n\n  __runHandler(target) {\n    const { __handlers } = this\n    for (let i = 0; i < __handlers.length; i++) {\n      if (__handlers[i] && target === __handlers[i].target) {\n        __handlers[i].handler &&\n          __handlers[i].handler.map((handler) => {\n            try {\n              handler()\n            } catch (error) {\n              console.error(error)\n            }\n          })\n        break\n      }\n    }\n  }\n\n  __trigger(entries) {\n    entries.map((item) => {\n      this.__runHandler(item.target)\n    })\n  }\n}\n\nconst resizeObserver = new ResizeObserver()\n\nfunction addObserver(target, handler) {\n  resizeObserver.addObserver(target, handler)\n}\n\nfunction unObserver(target, handler) {\n  resizeObserver.unObserver(target, handler)\n}\n\nfunction destroyObserver(target, handler) {\n  resizeObserver.destroyObserver(target, handler)\n}\n\nexport { addObserver, unObserver, destroyObserver }\n","\nvar content = require(\"!!../../node_modules/css-loader/index.js??ref--5-1!../../node_modules/postcss-loader/lib/index.js!../../node_modules/sass-loader/dist/cjs.js!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js??ref--5-1!../../node_modules/postcss-loader/lib/index.js!../../node_modules/sass-loader/dist/cjs.js!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js??ref--5-1!../../node_modules/postcss-loader/lib/index.js!../../node_modules/sass-loader/dist/cjs.js!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".danmu{overflow:hidden;-webkit-user-select:none;-moz-user-select:none;user-select:none;-ms-user-select:none}.danmu>*{position:absolute;white-space:nowrap}.danmu-switch{width:32px;height:20px;border-radius:100px;background-color:#ccc;-webkit-box-sizing:border-box;box-sizing:border-box;outline:none;cursor:pointer;position:relative;text-align:center;margin:10px auto}.danmu-switch.danmu-switch-active{padding-left:12px;background-color:#f85959}.danmu-switch span.txt{width:20px;height:20px;line-height:20px;text-align:center;display:block;border-radius:100px;background-color:#fff;-webkit-box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);box-shadow:-2px 0 0 0 rgba(0, 0, 0, .04);font-family:PingFangSC;font-size:10px;font-weight:500;color:#f44336}\", \"\"]);\n\n// exports\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target) {\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertInto + \" \" + options.insertAt.before);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n"],"sourceRoot":""}